"use strict";var Invoice=function(n){return n.ClearForm=function(n){$("#"+n+" #InvoiceId").val(null);$("#"+n+" #PONumberOriginal").val(null);$("#"+n+" #PONumber").val(null);$("#"+n+" #Supplier").val(null);$("#"+n+" #TotalPrice").val(null);$("#"+n+" #PurchaseDate").val(null)},n.ClearValidation=function(n){var i=document.getElementById(n),t=$(i).validate();$("[name]",i).each(function(){t.successList.push(this);t.showErrors()});t.resetForm();t.reset()},n.SortDropDown=function(n){var t=$(n+" option:first"),i=$(n+" option:not(:first)").sort(function(n,t){return n.text==t.text?0:n.text<parseInt(t.text)?-1:1});$(n).html(i).prepend(t)},n.Suppliers=function(n){if($("#InvoiceForm #Supplier").empty(),$("#InvoiceForm #Supplier").append($("<option><\/option>").val(null).html("Please Select")),$(n).length>0)for(var t=0;t<n.length;t++)$("#InvoiceForm #Supplier").append($("<option><\/option>").val(n[t].Id).html(n[t].DisplayName))},n.GetSuppliers=function(t){var i={};i.url=t+"Asset/Suppliers";i.type="POST";i.datatype="json";i.contentType="application/json";i.success=function(t){n.Suppliers(t)};i.error=function(){console.log("Error in Getting Suppliers!!")};$.ajax(i)},n.GetBlankInvoice=function(t){$("#BlankInvoice").click(function(){n.ClearForm("InvoiceForm");n.ClearValidation("InvoiceForm");$.when(n.GetSuppliers(t)).done(function(){$("#InvoiceForm #EditInvoice").hide();$("#InvoiceForm #CreateInvoice").show();$("#InvoiceModalLabel").html($("#BlankInvoice").data("type"));$("#InvoiceModal").modal({})})})},n.GetInvoice=function(t){$("#GetInvoice").click(function(){if($("#InvoiceItemForm #InvoiceNumber").val())n.ClearForm("InvoiceForm"),n.ClearValidation("InvoiceForm"),$.ajax({type:"Get",url:t,data:{Id:$("#InvoiceItemForm #InvoiceNumber").val()},success:function(t){var i=JSON.parse(t);$("#InvoiceForm #InvoiceId").val(i.Id);$("#InvoiceForm #PONumberOriginal").val(i.PONumber);$("#InvoiceForm #PONumber").val(i.PONumber);$("#InvoiceForm #SupplierIdOriginal").val(i.SupplierIdOriginal);$("#InvoiceForm #SupplierDisplayNameOriginal").val(i.SupplierDisplayNameOriginal);$("#InvoiceForm #TotalPrice").val(i.TotalPrice?i.TotalPrice.toFixed(2):null);$("#InvoiceForm #PurchaseDate").val(i.PurchaseDate?new Date(i.PurchaseDate).toISOString().slice(0,10):"");$.when(n.Suppliers(i.Suppliers)).done(function(){$("#InvoiceForm #Supplier").val(i.SupplierId);$("#InvoiceModalLabel").html($("#GetInvoice").data("type"));$("#InvoiceForm #EditInvoice").show();$("#InvoiceForm #CreateInvoice").hide();$("#InvoiceModal").modal({})})}})})},n.CreateInvoice=function(t){$("#CreateInvoice").click(function(){var i=$("#InvoiceForm").serialize();$.ajax({type:"Post",url:t,data:i,success:function(t){t.IsCreated?($("#InvoiceItemForm #InvoiceNumber").append($("<option><\/option>").val(t.Content.Id).text(t.Content.PONumber)),n.SortDropDown("#InvoiceItemForm #InvoiceNumber"),$("#InvoiceItemForm #InvoiceNumber").val(t.Content.Id),$("#InvoiceItemForm #InvoiceNumber").selectpicker("refresh"),$("#InvoiceModal").modal("hide")):($.when(n.Suppliers(t.Content.Suppliers)).done(function(){$("#InvoiceForm #Supplier").val(t.Content.SupplierId);$.each(t.errors,function(n,t){$('#InvoiceForm [id="Val_'+n+'"]').html(t);$("#"+n)[0].setCustomValidity("Error")})}),$("#CreateInvoice").attr("disabled",!0),$("#EditInvoice").attr("disabled",!0))}})})},n.EditInvoice=function(t){$("#EditInvoice").click(function(){var i=$("#InvoiceForm").serialize();$.ajax({type:"Post",url:t+"/"+$("#InvoiceId").val(),data:i,success:function(t){t.IsUpdated?($("#InvoiceItemForm #InvoiceNumber option:selected").text(t.Content.PONumber),n.SortDropDown("#InvoiceNumber"),$("#InvoiceItemForm #InvoiceNumber").val(t.Content.Id),$("#InvoiceItemForm #InvoiceNumber").selectpicker("refresh"),$("#InvoiceModal").modal("hide")):($.when(n.Suppliers(t.Content.Suppliers)).done(function(){$("#InvoiceForm #Supplier").val(t.Content.SupplierId);$.each(t.errors,function(n,t){$('#InvoiceForm [id="Val_'+n+'"]').html(t);$("#"+n)[0].setCustomValidity("Error")})}),$("#CreateInvoice").attr("disabled",!0),$("#EditInvoice").attr("disabled",!0))}})})},n.DisableEnableSubmit=function(n){$(":input").on("keyup",function(){this.setCustomValidity("");$(n)[0].checkValidity()?($("#CreateInvoice").removeAttr("disabled"),$("#EditInvoice").removeAttr("disabled")):($("#CreateInvoice").attr("disabled",!0),$("#EditInvoice").attr("disabled",!0))});$(":input").on("blur",function(){this.setCustomValidity("");$(n)[0].checkValidity()?($("#CreateInvoice").removeAttr("disabled"),$("#EditInvoice").removeAttr("disabled")):($("#CreateInvoice").attr("disabled",!0),$("#EditInvoice").attr("disabled",!0))});$(":input").change(function(){this.setCustomValidity("");$(n)[0].checkValidity()?($("#CreateInvoice").removeAttr("disabled"),$("#EditInvoice").removeAttr("disabled")):($("#CreateInvoice").attr("disabled",!0),$("#EditInvoice").attr("disabled",!0))})},n}({});